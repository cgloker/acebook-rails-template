
<p id="notice"><%= notice %></p>

<h1>Posts</h1>

<table >
  <thead>
    <tr>
      <th></th>
      <th>Post ID</th>
      <th>Username</th>
      <th>Name</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>

    <% @posts.each do |post| %>
      <tr>

        <td><%= post.post %></td> 
        <td><%= post.id %></td> 
         <td><%= post.user.username %></td>
         <td><%= post.user.first_name  %> <%= post.user.last_name%></td>
        <td><%= post.created_at.strftime("%A, %d %B %Y %l:%M%p") %></td>
        <td><%= time_ago_in_words(post.created_at, :limit => 1.day.ago).gsub('about','').gsub(/ mi.*/, 'm').gsub(/ h.*/, 'h')%> ago</td>
      </tr>
      <tr>
        <% if current_user === post.user %>
        <td>
        <div class="buttons-edit-delete">
        <%= link_to 'Edit', edit_post_path(post) %>
        <%= link_to 'Delete', post, method: :delete, data: { confirm: 'Are you sure?' } %>
        </div>
        </td>
         <% end %>
         </tr>

        <td>
        <div class="comment-box">
        <%= form_for @comment do |f| %>
        <%= f.hidden_field :user_id, value: current_user.id %>
        <%= f.hidden_field :post_id, value: post.id %>
        <div class="input-group-append">
        <%= f.text_field :body, placeholder: "Write a comment..." %>
        <div class="input-group-append">
        <%= f.submit "Post", class: "small-btn btn-success" %>
        </div>
        </div>
        <% end %>
        </div>
        <br>

        <% post.comments.each do |comment| %>
          <strong class="comments-username"><%= comment.user.username %></strong>
          <div class="comments"><%= comment.body %></div>
          <div class="comments-time text-muted">
          <%= time_ago_in_words(comment.created_at, :limit => 1.day.ago).gsub('about','').gsub(/ mi.*/, 'm').gsub(/ h.*/, 'h').gsub(/ a.*/, ' 1m')%> ago
          </div>
        <% end %>
 
        </td>
        
        
        </tr>
    <% end %>
    
  </tbody>
</table>

<br>

<%= link_to 'New Post', new_post_path %>
